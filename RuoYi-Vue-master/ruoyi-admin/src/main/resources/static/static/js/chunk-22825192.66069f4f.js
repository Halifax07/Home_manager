(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22825192"],{"82a3":function(t,e,a){"use strict";a.d(e,"d",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return c})),a.d(e,"b",(function(){return o}));var n=a("b775");function s(t){return Object(n["a"])({url:"/family/transactions/list",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/family/transactions/"+t,method:"get"})}function i(t){return Object(n["a"])({url:"/family/transactions",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/family/transactions",method:"put",data:t})}function o(t){return Object(n["a"])({url:"/family/transactions/"+t,method:"delete"})}},8678:function(t,e,a){"use strict";a.d(e,"e",(function(){return s})),a.d(e,"d",(function(){return r})),a.d(e,"a",(function(){return i})),a.d(e,"f",(function(){return c})),a.d(e,"c",(function(){return o})),a.d(e,"b",(function(){return l}));var n=a("b775");function s(t){return Object(n["a"])({url:"/family/members/list",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/family/members/"+t,method:"get"})}function i(t){return Object(n["a"])({url:"/family/members",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/family/members",method:"put",data:t})}function o(t){return Object(n["a"])({url:"/family/members/"+t,method:"delete"})}function l(){return Object(n["a"])({url:"/family/members/check-admin",method:"get"})}},e1a0:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"mb20",attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("本月收入")])]),a("div",{staticClass:"text-center"},[a("div",{staticClass:"amount income"},[t._v("+￥"+t._s(t.monthlyStats.income||0))]),a("div",{staticClass:"change-text"},[a("span",{class:t.monthlyStats.incomeChange>=0?"text-success":"text-danger"},[t._v(" "+t._s(t.monthlyStats.incomeChange>=0?"+":"")+t._s(t.monthlyStats.incomeChange||0)+"% ")]),a("span",{staticClass:"text-muted"},[t._v(" 较上月")])])])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("本月支出")])]),a("div",{staticClass:"text-center"},[a("div",{staticClass:"amount expense"},[t._v("-￥"+t._s(t.monthlyStats.expense||0))]),a("div",{staticClass:"change-text"},[a("span",{class:t.monthlyStats.expenseChange<=0?"text-success":"text-danger"},[t._v(" "+t._s(t.monthlyStats.expenseChange>=0?"+":"")+t._s(t.monthlyStats.expenseChange||0)+"% ")]),a("span",{staticClass:"text-muted"},[t._v(" 较上月")])])])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("本月结余")])]),a("div",{staticClass:"text-center"},[a("div",{staticClass:"amount",class:t.monthlyStats.balance>=0?"income":"expense"},[t._v(" "+t._s(t.monthlyStats.balance>=0?"+":"")+"￥"+t._s(t.monthlyStats.balance||0)+" ")]),a("div",{staticClass:"change-text"},[a("span",{staticClass:"text-muted"},[t._v("收入 - 支出")])])])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("家庭成员")])]),a("div",{staticClass:"text-center"},[a("div",{staticClass:"amount"},[t._v(t._s(t.familyMemberCount||0)+"人")]),a("div",{staticClass:"change-text"},[a("span",{staticClass:"text-muted"},[t._v(t._s(t.familyName||"我的家庭"))])])])])],1)],1),a("el-row",{staticClass:"mb20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("近6个月收支趋势")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("详细")])],1),a("div",{ref:"trendChart",staticStyle:{height:"300px"}})])],1),a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("支出分类统计")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[t._v("详细")])],1),a("div",{ref:"categoryChart",staticStyle:{height:"300px"}})])],1)],1),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("最近交易记录")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){return t.$router.push("/family/transactions")}}},[t._v("查看全部")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.recentTransactions}},[a("el-table-column",{attrs:{prop:"transactionDate",label:"时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.parseTime(e.row.transactionDate,"{m}-{d} {h}:{i}")))])]}}])}),a("el-table-column",{attrs:{prop:"txnType",label:"类型",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:"收入"===e.row.txnType?"success":"danger",size:"mini"}},[t._v(" "+t._s(e.row.txnType)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"category",label:"分类",width:"120"}}),a("el-table-column",{attrs:{prop:"amount",label:"金额",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:"收入"===e.row.txnType?"text-success":"text-danger"},[t._v(" "+t._s("收入"===e.row.txnType?"+":"-")+"￥"+t._s(e.row.amount)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"memberName",label:"操作人",width:"100"}}),a("el-table-column",{attrs:{prop:"note",label:"备注"}})],1)],1)],1)},s=[],r=a("c14f"),i=a("1da1"),c=(a("b680"),a("d3b7"),a("0643"),a("4e3e"),a("159b"),a("82a3")),o=a("8678"),l=a("313e"),u={name:"FamilyDashboard",data:function(){return{monthlyStats:{income:0,expense:0,balance:0,incomeChange:0,expenseChange:0},familyMemberCount:0,familyName:"",recentTransactions:[],trendChart:null,categoryChart:null}},mounted:function(){this.loadDashboardData(),this.initCharts()},beforeDestroy:function(){this.trendChart&&this.trendChart.dispose(),this.categoryChart&&this.categoryChart.dispose()},methods:{loadDashboardData:function(){var t=this;return Object(i["a"])(Object(r["a"])().m((function e(){var a;return Object(r["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.loadRecentTransactions();case 1:return e.n=2,t.loadMonthlyStats();case 2:return e.n=3,t.loadFamilyInfo();case 3:t.updateCharts(),e.n=5;break;case 4:e.p=4,a=e.v,console.error("加载数据失败:",a);case 5:return e.a(2)}}),e,null,[[0,4]])})))()},loadRecentTransactions:function(){var t=this;return Object(i["a"])(Object(r["a"])().m((function e(){var a;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,Object(c["d"])({pageNum:1,pageSize:10});case 1:a=e.v,t.recentTransactions=a.rows||[];case 2:return e.a(2)}}),e)})))()},loadMonthlyStats:function(){var t=this;return Object(i["a"])(Object(r["a"])().m((function e(){var a,n,s,i,o,l,u;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return a=new Date,n=a.getMonth()+1,s=a.getFullYear(),e.n=1,Object(c["d"])({pageNum:1,pageSize:1e3});case 1:i=e.v,o=i.rows||[],l=0,u=0,o.forEach((function(t){var e=new Date(t.transactionDate);e.getMonth()+1===n&&e.getFullYear()===s&&("收入"===t.txnType?l+=parseFloat(t.amount):u+=parseFloat(t.amount))})),t.monthlyStats={income:l.toFixed(2),expense:u.toFixed(2),balance:(l-u).toFixed(2),incomeChange:0,expenseChange:0};case 2:return e.a(2)}}),e)})))()},loadFamilyInfo:function(){var t=this;return Object(i["a"])(Object(r["a"])().m((function e(){var a;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,Object(o["e"])({pageNum:1,pageSize:100});case 1:a=e.v,t.familyMemberCount=a.total||0,t.familyName="我的家庭";case 2:return e.a(2)}}),e)})))()},initCharts:function(){var t=this;this.trendChart=l["init"](this.$refs.trendChart),this.categoryChart=l["init"](this.$refs.categoryChart),window.addEventListener("resize",(function(){t.trendChart&&t.trendChart.resize(),t.categoryChart&&t.categoryChart.resize()}))},updateCharts:function(){this.updateTrendChart(),this.updateCategoryChart()},updateTrendChart:function(){var t={title:{text:""},tooltip:{trigger:"axis"},legend:{data:["收入","支出"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["1月","2月","3月","4月","5月","6月"]},yAxis:{type:"value"},series:[{name:"收入",type:"line",data:[1200,1320,1010,1340,1290,1330],itemStyle:{color:"#67C23A"}},{name:"支出",type:"line",data:[820,932,901,934,1290,1230],itemStyle:{color:"#F56C6C"}}]};this.trendChart.setOption(t)},updateCategoryChart:function(){var t={title:{text:"",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"支出分类",type:"pie",radius:"50%",data:[{value:1048,name:"餐饮"},{value:735,name:"交通"},{value:580,name:"购物"},{value:484,name:"娱乐"},{value:300,name:"其他"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};this.categoryChart.setOption(t)}}},d=u,h=(a("fac2"),a("2877")),m=Object(h["a"])(d,n,s,!1,null,"40421296",null);e["default"]=m.exports},eb36:function(t,e,a){},fac2:function(t,e,a){"use strict";a("eb36")}}]);